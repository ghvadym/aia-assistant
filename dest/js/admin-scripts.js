(function(a){a(document).ready(function(){const l=aiajax.ajaxurl;aiajax.nonce,a(".aia_form__submit").length&&a(document).on("click",".aia_form__submit",function(){const e=a(this),i=a(e).closest(".aia"),s=a(i).find(".aia__response"),t=a(i).find(".aia__content"),c=a(i).find(".aia__error");if(!d(i))return f("#aia-fields"),!1;jQuery.ajax({type:"POST",url:l,data:{action:"ai_prompt",id:a(e).data("id"),type:a(e).data("type"),topic:a(i).find("#aia-topic").val(),keywords:a(i).find("#aia-keywords").val(),voice:a(i).find("#aia-tone-voice").val(),words:a(i).find("#aia-words-count").val(),lang:a(i).find("#aia-language option:selected").val(),point_of_view:a(i).find("#aia-point-of-view option:selected").val()},beforeSend:function(){a(i).addClass("_spinner")},success:function(n){n.success&&n.answer&&(a(s).html(n.answer),a(t).addClass("active"),a(t).removeClass("issue"),a(c).empty()),n.error&&n.message&&(a(s).empty(),a(c).html(n.message),a(t).removeClass("active"),a(t).addClass("issue")),a(i).removeClass("_spinner")},error:function(n){console.log("error",n)}})});function d(e){if(!e)return;let i=0;const s=a(e).find("input, select"),t=["aia-topic"];return s?(a(s).each(function(c,n){const r=a(this).attr("name");a(this).val()?jQuery.inArray(r,t)!==-1&&a(this).removeClass("not_valid"):jQuery.inArray(r,t)!==-1&&(a(this).addClass("not_valid"),i++)}),!i):!1}function f(e){e&&a([document.documentElement,document.body]).animate({scrollTop:a(e).offset().top},500)}a(".aia__action_clear").length&&a(document).on("click",".aia__action_clear",function(){const e=a(this).closest(".aia__content");a(e).find(".aia__response").empty(),a(e).find(".aia__error").empty()});const o=a(".aia__action_copy");o.length&&a(document).on("click",".aia__action_copy",function(){const e=a(this).closest(".aia__content").find(".aia__response");if(!e||!a(e).html())return!1;u(a(e).html()),a(o).addClass("active"),a(o).append("<span>Copied!</span>"),setTimeout(function(){a(o).removeClass("active")},1500),setTimeout(function(){a(o).find("span").remove()},2e3)});function u(e){if(!e)return;let i=a("<input>");a("body").append(i),i.val(e).select(),document.execCommand("copy"),i.remove()}})})(jQuery);
